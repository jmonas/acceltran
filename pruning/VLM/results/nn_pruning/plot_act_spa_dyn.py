import matplotlib.pyplot as plt
import pandas as pd


tiny_output = [{"pruning_threshold": 0.0, "k": None, "activation_sparsity": 0, "overall": 44.73, "perAnswerType": {"other": 29.2, "yes/no": 66.84, "number": 34.56}}, {"pruning_threshold": 0.005, "k": None, "activation_sparsity": 0.26187482632427245, "overall": 44.33, "perAnswerType": {"other": 28.6, "yes/no": 66.63, "number": 34.34}}, {"pruning_threshold": 0.01, "k": None, "activation_sparsity": 0.3106718708339538, "overall": 44.06, "perAnswerType": {"other": 28.3, "yes/no": 66.37, "number": 34.08}}, {"pruning_threshold": 0.015, "k": None, "activation_sparsity": 0.33624708821412197, "overall": 44.03, "perAnswerType": {"other": 28.01, "yes/no": 66.84, "number": 33.49}}, {"pruning_threshold": 0.02, "k": None, "activation_sparsity": 0.3540652768405058, "overall": 43.81, "perAnswerType": {"other": 27.49, "yes/no": 66.81, "number": 33.86}}, {"pruning_threshold": 0.025, "k": None, "activation_sparsity": 0.36532845324539703, "overall": 43.4, "perAnswerType": {"other": 26.73, "yes/no": 66.69, "number": 33.86}}, {"pruning_threshold": 0.03, "k": None, "activation_sparsity": 0.3771235159376363, "overall": 42.93, "perAnswerType": {"other": 26.01, "yes/no": 66.44, "number": 33.64}}, {"pruning_threshold": 0.035, "k": None, "activation_sparsity": 0.38568797166758784, "overall": 43.19, "perAnswerType": {"other": 26.22, "yes/no": 66.82, "number": 33.68}}, {"pruning_threshold": 0.04, "k": None, "activation_sparsity": 0.39343962180514347, "overall": 43.78, "perAnswerType": {"other": 26.92, "yes/no": 67.13, "number": 34.78}}, {"pruning_threshold": 0.045, "k": None, "activation_sparsity": 0.4003655641016244, "overall": 43.69, "perAnswerType": {"other": 26.76, "yes/no": 67.21, "number": 34.41}}, {"pruning_threshold": 0.05, "k": None, "activation_sparsity": 0.4077162082722841, "overall": 43.88, "perAnswerType": {"other": 27.12, "yes/no": 67.35, "number": 34.04}}, {"pruning_threshold": 0.055, "k": None, "activation_sparsity": 0.4145873071059607, "overall": 43.8, "perAnswerType": {"other": 27.15, "yes/no": 67.04, "number": 34.3}}, {"pruning_threshold": 0.06, "k": None, "activation_sparsity": 0.420829316243676, "overall": 43.5, "perAnswerType": {"other": 26.62, "yes/no": 66.97, "number": 34.15}}, {"pruning_threshold": 0.065, "k": None, "activation_sparsity": 0.4271909980256837, "overall": 44.12, "perAnswerType": {"other": 27.2, "yes/no": 67.6, "number": 34.93}}, {"pruning_threshold": 0.07, "k": None, "activation_sparsity": 0.43365900476698555, "overall": 43.71, "perAnswerType": {"other": 26.73, "yes/no": 67.32, "number": 34.3}}, {"pruning_threshold": 0.075, "k": None, "activation_sparsity": 0.4399800338443991, "overall": 43.78, "perAnswerType": {"other": 26.81, "yes/no": 67.12, "number": 35.18}}, {"pruning_threshold": 0.08, "k": None, "activation_sparsity": 0.44614868743270153, "overall": 43.74, "perAnswerType": {"other": 27.37, "yes/no": 66.9, "number": 33.46}}, {"pruning_threshold": 0.085, "k": None, "activation_sparsity": 0.45260413573497793, "overall": 43.54, "perAnswerType": {"other": 26.79, "yes/no": 66.65, "number": 34.78}}, {"pruning_threshold": 0.09, "k": None, "activation_sparsity": 0.459065277042028, "overall": 43.1, "perAnswerType": {"other": 26.11, "yes/no": 66.23, "number": 35.26}}, {"pruning_threshold": 0.095, "k": None, "activation_sparsity": 0.46491198198738315, "overall": 42.84, "perAnswerType": {"other": 26.26, "yes/no": 65.66, "number": 34.38}}, {"pruning_threshold": 0.1, "k": None, "activation_sparsity": 0.4710106655023719, "overall": 42.63, "perAnswerType": {"other": 26.23, "yes/no": 65.22, "number": 34.19}}, {"pruning_threshold": 0.105, "k": None, "activation_sparsity": 0.47727378579876373, "overall": 42.74, "perAnswerType": {"other": 25.78, "yes/no": 66.11, "number": 34.04}}, {"pruning_threshold": 0.11, "k": None, "activation_sparsity": 0.483858312554156, "overall": 42.34, "perAnswerType": {"other": 26.16, "yes/no": 65.14, "number": 32.46}}, {"pruning_threshold": 0.115, "k": None, "activation_sparsity": 0.4901545677676144, "overall": 42.57, "perAnswerType": {"other": 25.96, "yes/no": 65.39, "number": 34.19}}, {"pruning_threshold": 0.12, "k": None, "activation_sparsity": 0.49604427080670316, "overall": 42.36, "perAnswerType": {"other": 25.54, "yes/no": 65.51, "number": 33.82}}, {"pruning_threshold": 0.125, "k": None, "activation_sparsity": 0.5021024286073954, "overall": 42.39, "perAnswerType": {"other": 25.17, "yes/no": 66.09, "number": 33.68}}, {"pruning_threshold": 0.13, "k": None, "activation_sparsity": 0.5076318039694829, "overall": 42.18, "perAnswerType": {"other": 24.55, "yes/no": 66.17, "number": 34.04}}, {"pruning_threshold": 0.135, "k": None, "activation_sparsity": 0.5139442341068488, "overall": 42.26, "perAnswerType": {"other": 24.64, "yes/no": 66.11, "number": 34.52}}, {"pruning_threshold": 0.14, "k": None, "activation_sparsity": 0.5188122474308403, "overall": 41.92, "perAnswerType": {"other": 23.9, "yes/no": 66.09, "number": 34.74}}, {"pruning_threshold": 0.145, "k": None, "activation_sparsity": 0.5244999680223821, "overall": 42.13, "perAnswerType": {"other": 24.07, "yes/no": 66.12, "number": 35.59}}]
small_output = [{"pruning_threshold": 0.0, "k": None, "activation_sparsity": 0, "overall": 48.76, "perAnswerType": {"other": 34.43, "yes/no": 70.45, "number": 35.37}}, {"pruning_threshold": 0.005, "k": None, "activation_sparsity": 0.28907761707797563, "overall": 48.4, "perAnswerType": {"other": 33.59, "yes/no": 71.0, "number": 33.97}}, {"pruning_threshold": 0.01, "k": None, "activation_sparsity": 0.33705996269796956, "overall": 48.03, "perAnswerType": {"other": 33.56, "yes/no": 70.37, "number": 33.16}}, {"pruning_threshold": 0.015, "k": None, "activation_sparsity": 0.36022710549233405, "overall": 47.7, "perAnswerType": {"other": 32.89, "yes/no": 70.51, "number": 32.57}}, {"pruning_threshold": 0.02, "k": None, "activation_sparsity": 0.3748408547356573, "overall": 47.19, "perAnswerType": {"other": 32.31, "yes/no": 69.92, "number": 32.61}}, {"pruning_threshold": 0.025, "k": None, "activation_sparsity": 0.38552667651769396, "overall": 47.06, "perAnswerType": {"other": 31.45, "yes/no": 70.53, "number": 32.94}}, {"pruning_threshold": 0.03, "k": None, "activation_sparsity": 0.3948068987898618, "overall": 46.67, "perAnswerType": {"other": 30.87, "yes/no": 70.35, "number": 32.57}}, {"pruning_threshold": 0.035, "k": None, "activation_sparsity": 0.40246893672974793, "overall": 46.59, "perAnswerType": {"other": 30.43, "yes/no": 70.37, "number": 33.57}}, {"pruning_threshold": 0.04, "k": None, "activation_sparsity": 0.40978356987328496, "overall": 46.4, "perAnswerType": {"other": 30.16, "yes/no": 70.3, "number": 33.35}}, {"pruning_threshold": 0.045, "k": None, "activation_sparsity": 0.41625840647178114, "overall": 46.38, "perAnswerType": {"other": 30.22, "yes/no": 70.13, "number": 33.46}}, {"pruning_threshold": 0.05, "k": None, "activation_sparsity": 0.4232828819667332, "overall": 46.22, "perAnswerType": {"other": 29.94, "yes/no": 70.04, "number": 33.57}}, {"pruning_threshold": 0.055, "k": None, "activation_sparsity": 0.42862541121097064, "overall": 46.19, "perAnswerType": {"other": 30.22, "yes/no": 69.81, "number": 32.94}}, {"pruning_threshold": 0.06, "k": None, "activation_sparsity": 0.4351677997015305, "overall": 46.4, "perAnswerType": {"other": 30.17, "yes/no": 70.43, "number": 32.94}}, {"pruning_threshold": 0.065, "k": None, "activation_sparsity": 0.44123535094295546, "overall": 46.36, "perAnswerType": {"other": 29.93, "yes/no": 70.59, "number": 32.94}}, {"pruning_threshold": 0.07, "k": None, "activation_sparsity": 0.44646436139310985, "overall": 46.28, "perAnswerType": {"other": 29.86, "yes/no": 70.27, "number": 33.57}}, {"pruning_threshold": 0.075, "k": None, "activation_sparsity": 0.4524491352277412, "overall": 46.22, "perAnswerType": {"other": 29.9, "yes/no": 70.35, "number": 32.68}}, {"pruning_threshold": 0.08, "k": None, "activation_sparsity": 0.45796638803653744, "overall": 46.16, "perAnswerType": {"other": 29.8, "yes/no": 70.46, "number": 32.32}}, {"pruning_threshold": 0.085, "k": None, "activation_sparsity": 0.46350490500301805, "overall": 46.0, "perAnswerType": {"other": 29.92, "yes/no": 70.06, "number": 31.84}}, {"pruning_threshold": 0.09, "k": None, "activation_sparsity": 0.46905991344797726, "overall": 46.07, "perAnswerType": {"other": 29.99, "yes/no": 70.07, "number": 32.06}}, {"pruning_threshold": 0.095, "k": None, "activation_sparsity": 0.4743691084264613, "overall": 46.02, "perAnswerType": {"other": 29.79, "yes/no": 70.17, "number": 32.17}}, {"pruning_threshold": 0.1, "k": None, "activation_sparsity": 0.47988350110969236, "overall": 45.57, "perAnswerType": {"other": 29.7, "yes/no": 69.36, "number": 31.43}}, {"pruning_threshold": 0.105, "k": None, "activation_sparsity": 0.4849487537237308, "overall": 45.81, "perAnswerType": {"other": 29.18, "yes/no": 70.2, "number": 32.68}}, {"pruning_threshold": 0.11, "k": None, "activation_sparsity": 0.49040172743018806, "overall": 45.13, "perAnswerType": {"other": 28.72, "yes/no": 69.15, "number": 32.28}}, {"pruning_threshold": 0.115, "k": None, "activation_sparsity": 0.49540279825785677, "overall": 45.06, "perAnswerType": {"other": 28.57, "yes/no": 69.01, "number": 32.79}}, {"pruning_threshold": 0.12, "k": None, "activation_sparsity": 0.5002740202604298, "overall": 45.16, "perAnswerType": {"other": 28.94, "yes/no": 68.5, "number": 33.75}}, {"pruning_threshold": 0.125, "k": None, "activation_sparsity": 0.5052431042133242, "overall": 45.13, "perAnswerType": {"other": 29.2, "yes/no": 68.59, "number": 32.24}}, {"pruning_threshold": 0.13, "k": None, "activation_sparsity": 0.5104745732557308, "overall": 45.01, "perAnswerType": {"other": 29.27, "yes/no": 68.26, "number": 32.1}}, {"pruning_threshold": 0.135, "k": None, "activation_sparsity": 0.5151018182463836, "overall": 45.12, "perAnswerType": {"other": 29.52, "yes/no": 68.13, "number": 32.39}}, {"pruning_threshold": 0.14, "k": None, "activation_sparsity": 0.519893112496938, "overall": 45.03, "perAnswerType": {"other": 29.38, "yes/no": 67.96, "number": 32.76}}, {"pruning_threshold": 0.145, "k": None, "activation_sparsity": 0.524512092661292, "overall": 44.51, "perAnswerType": {"other": 29.08, "yes/no": 67.1, "number": 32.39}}]
medium_output = [{"pruning_threshold": 0.0, "k": None, "activation_sparsity": 0, "overall": 50.41, "perAnswerType": {"other": 36.43, "yes/no": 72.35, "number": 34.89}}, {"pruning_threshold": 0.005, "k": None, "activation_sparsity": 0.27469072779127945, "overall": 49.45, "perAnswerType": {"other": 35.12, "yes/no": 71.34, "number": 35.48}}, {"pruning_threshold": 0.01, "k": None, "activation_sparsity": 0.31648645120788643, "overall": 47.49, "perAnswerType": {"other": 32.47, "yes/no": 70.67, "number": 32.06}}, {"pruning_threshold": 0.015, "k": None, "activation_sparsity": 0.33643423988919385, "overall": 46.03, "perAnswerType": {"other": 29.25, "yes/no": 70.66, "number": 32.68}}, {"pruning_threshold": 0.02, "k": None, "activation_sparsity": 0.34914210434282633, "overall": 44.68, "perAnswerType": {"other": 27.31, "yes/no": 69.85, "number": 31.91}}, {"pruning_threshold": 0.025, "k": None, "activation_sparsity": 0.35938378124273773, "overall": 43.79, "perAnswerType": {"other": 26.26, "yes/no": 68.75, "number": 32.28}}, {"pruning_threshold": 0.03, "k": None, "activation_sparsity": 0.3683225978559613, "overall": 43.08, "perAnswerType": {"other": 25.21, "yes/no": 68.29, "number": 32.06}}, {"pruning_threshold": 0.035, "k": None, "activation_sparsity": 0.3757468102037332, "overall": 42.73, "perAnswerType": {"other": 24.53, "yes/no": 68.43, "number": 31.47}}, {"pruning_threshold": 0.04, "k": None, "activation_sparsity": 0.3821156587381407, "overall": 42.34, "perAnswerType": {"other": 23.76, "yes/no": 68.37, "number": 31.47}}, {"pruning_threshold": 0.045, "k": None, "activation_sparsity": 0.38848862511032034, "overall": 42.0, "perAnswerType": {"other": 22.93, "yes/no": 68.51, "number": 31.47}}, {"pruning_threshold": 0.05, "k": None, "activation_sparsity": 0.39478230249857393, "overall": 41.63, "perAnswerType": {"other": 22.51, "yes/no": 68.24, "number": 30.99}}, {"pruning_threshold": 0.055, "k": None, "activation_sparsity": 0.40036207149062775, "overall": 40.89, "perAnswerType": {"other": 21.63, "yes/no": 67.4, "number": 31.1}}, {"pruning_threshold": 0.06, "k": None, "activation_sparsity": 0.4054642921171529, "overall": 40.89, "perAnswerType": {"other": 21.81, "yes/no": 67.04, "number": 31.47}}, {"pruning_threshold": 0.065, "k": None, "activation_sparsity": 0.41044544376654857, "overall": 40.64, "perAnswerType": {"other": 21.11, "yes/no": 67.29, "number": 31.43}}, {"pruning_threshold": 0.07, "k": None, "activation_sparsity": 0.4154968838088009, "overall": 40.37, "perAnswerType": {"other": 20.91, "yes/no": 67.08, "number": 30.7}}, {"pruning_threshold": 0.075, "k": None, "activation_sparsity": 0.41975948623721737, "overall": 40.34, "perAnswerType": {"other": 20.81, "yes/no": 66.96, "number": 31.21}}, {"pruning_threshold": 0.08, "k": None, "activation_sparsity": 0.42444131767406706, "overall": 39.69, "perAnswerType": {"other": 20.02, "yes/no": 66.55, "number": 30.33}}, {"pruning_threshold": 0.085, "k": None, "activation_sparsity": 0.42865892839188946, "overall": 39.96, "perAnswerType": {"other": 20.06, "yes/no": 67.03, "number": 30.81}}, {"pruning_threshold": 0.09, "k": None, "activation_sparsity": 0.4327420581945143, "overall": 39.7, "perAnswerType": {"other": 19.32, "yes/no": 67.19, "number": 31.07}}, {"pruning_threshold": 0.095, "k": None, "activation_sparsity": 0.43675548955908805, "overall": 39.74, "perAnswerType": {"other": 19.14, "yes/no": 67.49, "number": 31.1}}, {"pruning_threshold": 0.1, "k": None, "activation_sparsity": 0.4407315473435701, "overall": 39.65, "perAnswerType": {"other": 19.21, "yes/no": 67.14, "number": 31.29}}, {"pruning_threshold": 0.105, "k": None, "activation_sparsity": 0.44485497410190333, "overall": 39.45, "perAnswerType": {"other": 18.88, "yes/no": 67.34, "number": 30.33}}, {"pruning_threshold": 0.11, "k": None, "activation_sparsity": 0.44848089729261165, "overall": 39.13, "perAnswerType": {"other": 18.53, "yes/no": 66.87, "number": 30.55}}, {"pruning_threshold": 0.115, "k": None, "activation_sparsity": 0.4522920240563913, "overall": 39.46, "perAnswerType": {"other": 19.19, "yes/no": 66.93, "number": 30.48}}, {"pruning_threshold": 0.12, "k": None, "activation_sparsity": 0.45608252140813904, "overall": 39.55, "perAnswerType": {"other": 18.65, "yes/no": 67.55, "number": 31.32}}, {"pruning_threshold": 0.125, "k": None, "activation_sparsity": 0.4596383272381324, "overall": 39.81, "perAnswerType": {"other": 18.84, "yes/no": 68.01, "number": 31.21}}, {"pruning_threshold": 0.13, "k": None, "activation_sparsity": 0.4633602822147053, "overall": 39.28, "perAnswerType": {"other": 18.33, "yes/no": 67.64, "number": 30.11}}, {"pruning_threshold": 0.135, "k": None, "activation_sparsity": 0.46657161449305423, "overall": 39.23, "perAnswerType": {"other": 17.96, "yes/no": 67.67, "number": 30.99}}, {"pruning_threshold": 0.14, "k": None, "activation_sparsity": 0.4704107156054696, "overall": 39.1, "perAnswerType": {"other": 17.78, "yes/no": 67.65, "number": 30.7}}, {"pruning_threshold": 0.145, "k": None, "activation_sparsity": 0.47377803712180944, "overall": 38.81, "perAnswerType": {"other": 17.5, "yes/no": 67.42, "number": 30.22}}]

tiny_data = [
    {
        "pruning_threshold": item["pruning_threshold"],
        "activation_sparsity": item["activation_sparsity"],
        "overall": item["overall"],
    }
    for item in tiny_output
]

small_data = [
    {
        "pruning_threshold": item["pruning_threshold"],
        "activation_sparsity": item["activation_sparsity"],
        "overall": item["overall"],
    }
    for item in small_output
]

medium_data = [
    {
        "pruning_threshold": item["pruning_threshold"],
        "activation_sparsity": item["activation_sparsity"],
        "overall": item["overall"],
    }
    for item in medium_output
]

df_tiny = pd.DataFrame(tiny_data)
df_small = pd.DataFrame(small_data)
df_medium = pd.DataFrame(medium_data)

# Plotting
fig, ax1 = plt.subplots(figsize=(5, 6))
plt.grid()
# Plot the overall accuracy
ax1.set_xlabel('Pruning threshold')
ax1.set_ylabel('Accuracy on VQA (%)', )
ax1.plot(df_tiny['pruning_threshold'], df_tiny['overall'], ls="--", color="lightcoral", marker="o", label= "ViLT-Tiny Acc.")
ax1.plot(df_tiny['pruning_threshold'], df_small['overall'],  ls="--",color="mediumseagreen", marker="o", label= "ViLT-Small Acc.")
ax1.plot(df_tiny['pruning_threshold'], df_medium['overall'],  ls="--",color="deepskyblue", marker="o", label= "ViLT-Medium Acc.")

ax1.tick_params(axis='y', labelcolor="black")


# Instantiate a second axes that shares the same x-axis
ax2 = ax1.twinx()

# Plot the activation sparsity on the same plot with a second y-axis
ax2.set_ylabel('Activation Sparsity (%)')
ax2.plot(df_tiny['pruning_threshold'], df_tiny['activation_sparsity']*100, color="maroon", marker="^", label= "ViLT-Tiny Act. sp.")
ax2.plot(df_tiny['pruning_threshold'], df_small['activation_sparsity']*100, color="darkgreen", marker="^", label= "ViLT-Small Act. sp.")
ax2.plot(df_medium['pruning_threshold'], df_medium['activation_sparsity']*100, color="royalblue", marker="^", label= "ViLT-Medium Act. sp.")

ax2.tick_params(axis='y', )
# Show the plot
fig.tight_layout()
handles1, labels1 = ax1.get_legend_handles_labels()
handles2, labels2 = ax2.get_legend_handles_labels()
legend = ax2.legend(handles1 + handles2, labels1 + labels2, loc='lower left').set_zorder(102)
# legend.get_texts()[3].set_color("dimgray")
# legend.get_texts()[4].set_color("dimgray")
# legend.get_texts()[5].set_color("dimgray")

plt.show()